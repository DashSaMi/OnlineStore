{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/saman/OneDrive/Desktop/OnlineStore/dashboard/src/lib/api/products.js"],"sourcesContent":["const API_BASE_URL = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://localhost:3000';\r\n\r\n// Helper function for API requests\r\nasync function makeRequest(endpoint, method = 'GET', body = null) {\r\n  const headers = {\r\n    'Content-Type': 'application/json',\r\n  };\r\n\r\n  // Try to get the session token if available\r\n  try {\r\n    const token = await getSessionToken(); // Make sure this function is properly implemented\r\n    if (token) {\r\n      headers['Authorization'] = `Bearer ${token}`;\r\n    }\r\n  } catch (error) {\r\n    console.log('No session token available');\r\n  }\r\n\r\n  const config = {\r\n    method,\r\n    headers,\r\n    cache: 'no-store',\r\n    credentials: 'include' // Important for cookies/session\r\n  };\r\n\r\n  if (body) {\r\n    config.body = JSON.stringify(body);\r\n  }\r\n\r\n  try {\r\n    const response = await fetch(`${API_BASE_URL}${endpoint}`, config);\r\n    \r\n    if (!response.ok) {\r\n      const errorData = await response.json().catch(() => ({}));\r\n      throw new Error(errorData.message || errorData.error || `HTTP error! status: ${response.status}`);\r\n    }\r\n\r\n    return await response.json();\r\n  } catch (error) {\r\n    console.error(`API Error (${method} ${endpoint}):`, error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n// Fetch all products\r\nexport async function fetchProducts() {\r\n  return makeRequest('/api/products');\r\n}\r\n\r\n// Fetch single product by ID\r\nexport async function fetchProductById(id) {\r\n  return makeRequest(`/api/products/${id}`);\r\n}\r\n\r\n// Create new product\r\nexport async function createProduct(productData) {\r\n  return makeRequest('/api/products', 'POST', productData);\r\n}\r\n\r\n// Update existing product\r\nexport async function updateProduct(id, productData) {\r\n  return makeRequest(`/api/products/${id}`, 'PUT', productData);\r\n}\r\n\r\n// Delete product\r\nexport async function deleteProduct(id) {\r\n  return makeRequest(`/api/products/${id}`, 'DELETE');\r\n}"],"names":[],"mappings":";;;;;;;AAAqB;AAArB,MAAM,eAAe,6DAAwC;AAE7D,mCAAmC;AACnC,eAAe,YAAY,QAAQ;QAAE,SAAA,iEAAS,OAAO,OAAA,iEAAO;IAC1D,MAAM,UAAU;QACd,gBAAgB;IAClB;IAEA,4CAA4C;IAC5C,IAAI;QACF,MAAM,QAAQ,MAAM,mBAAmB,kDAAkD;QACzF,IAAI,OAAO;YACT,OAAO,CAAC,gBAAgB,GAAG,AAAC,UAAe,OAAN;QACvC;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,GAAG,CAAC;IACd;IAEA,MAAM,SAAS;QACb;QACA;QACA,OAAO;QACP,aAAa,UAAU,gCAAgC;IACzD;IAEA,IAAI,MAAM;QACR,OAAO,IAAI,GAAG,KAAK,SAAS,CAAC;IAC/B;IAEA,IAAI;QACF,MAAM,WAAW,MAAM,MAAM,AAAC,GAAiB,OAAf,cAAwB,OAAT,WAAY;QAE3D,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,MAAM,YAAY,MAAM,SAAS,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;YACvD,MAAM,IAAI,MAAM,UAAU,OAAO,IAAI,UAAU,KAAK,IAAI,AAAC,uBAAsC,OAAhB,SAAS,MAAM;QAChG;QAEA,OAAO,MAAM,SAAS,IAAI;IAC5B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,AAAC,cAAuB,OAAV,QAAO,KAAY,OAAT,UAAS,OAAK;QACpD,MAAM;IACR;AACF;AAGO,eAAe;IACpB,OAAO,YAAY;AACrB;AAGO,eAAe,iBAAiB,EAAE;IACvC,OAAO,YAAY,AAAC,iBAAmB,OAAH;AACtC;AAGO,eAAe,cAAc,WAAW;IAC7C,OAAO,YAAY,iBAAiB,QAAQ;AAC9C;AAGO,eAAe,cAAc,EAAE,EAAE,WAAW;IACjD,OAAO,YAAY,AAAC,iBAAmB,OAAH,KAAM,OAAO;AACnD;AAGO,eAAe,cAAc,EAAE;IACpC,OAAO,YAAY,AAAC,iBAAmB,OAAH,KAAM;AAC5C","debugId":null}},
    {"offset": {"line": 76, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/saman/OneDrive/Desktop/OnlineStore/dashboard/src/app/dashboard/products/add/page.js"],"sourcesContent":["'use client';\r\nimport { useRouter } from 'next/navigation';\r\nimport { createProduct } from '@/lib/api/products';\r\nimport { useState } from 'react';\r\nimport { useForm } from 'react-hook-form';\r\nimport { zodResolver } from '@hookform/resolvers/zod';\r\nimport * as z from 'zod';\r\n\r\n// Define validation schema\r\nconst productSchema = z.object({\r\n  name: z.string().min(3, 'نام محصول باید حداقل 3 کاراکتر باشد'),\r\n  price: z.number().min(1000, 'قیمت باید حداقل 1000 ریال باشد'),\r\n  description: z.string().min(10, 'توضیحات باید حداقل 10 کاراکتر باشد'),\r\n  categories: z.string().min(2, 'حداقل یک دسته‌بندی وارد کنید'),\r\n  stock: z.number().min(0, 'موجودی نمی‌تواند منفی باشد'),\r\n  imageUrl: z.string().url('آدرس تصویر معتبر نیست')\r\n});\r\n\r\nexport default function AddProductPage() {\r\n  const router = useRouter();\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [serverError, setServerError] = useState(null);\r\n  \r\n  const {\r\n    register,\r\n    handleSubmit,\r\n    formState: { errors },\r\n    setError: setFormError\r\n  } = useForm({\r\n    resolver: zodResolver(productSchema)\r\n  });\r\n\r\n  const onSubmit = async (data) => {\r\n    setIsSubmitting(true);\r\n    setServerError(null);\r\n    \r\n    try {\r\n      const productData = {\r\n        ...data,\r\n        categories: data.categories.split(',').map(c => c.trim()),\r\n        price: Number(data.price),\r\n        stock: Number(data.stock)\r\n      };\r\n\r\n      const result = await createProduct(productData);\r\n      \r\n      if (result.success) {\r\n        router.push('/dashboard/products');\r\n        router.refresh();\r\n      } else {\r\n        setServerError(result.error || 'خطا در ثبت محصول');\r\n      }\r\n    } catch (err) {\r\n      console.error('Error creating product:', err);\r\n      setServerError(err.message || 'خطا در ارتباط با سرور');\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-6 max-w-4xl mx-auto\">\r\n      <h1 className=\"text-2xl font-bold mb-6 text-gray-800\">افزودن محصول جدید</h1>\r\n      \r\n      {/* Error messages */}\r\n      {serverError && (\r\n        <div className=\"mb-4 p-4 bg-red-100 text-red-700 rounded-lg border border-red-200\">\r\n          {serverError}\r\n        </div>\r\n      )}\r\n\r\n      <form onSubmit={handleSubmit(onSubmit)} className=\"bg-white p-6 rounded-lg shadow-md\">\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n          {/* Name Field */}\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">نام محصول*</label>\r\n            <input\r\n              type=\"text\"\r\n              {...register('name')}\r\n              className={`w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${\r\n                errors.name ? 'border-red-500' : 'border-gray-300'\r\n              }`}\r\n              disabled={isSubmitting}\r\n            />\r\n            {errors.name && (\r\n              <p className=\"mt-1 text-sm text-red-600\">{errors.name.message}</p>\r\n            )}\r\n          </div>\r\n          \r\n          {/* Price Field */}\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">قیمت (ریال)*</label>\r\n            <input\r\n              type=\"number\"\r\n              {...register('price', { valueAsNumber: true })}\r\n              min=\"1000\"\r\n              className={`w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${\r\n                errors.price ? 'border-red-500' : 'border-gray-300'\r\n              }`}\r\n              disabled={isSubmitting}\r\n            />\r\n            {errors.price && (\r\n              <p className=\"mt-1 text-sm text-red-600\">{errors.price.message}</p>\r\n            )}\r\n          </div>\r\n          \r\n          {/* Categories Field */}\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">دسته‌بندی‌ها (با کاما جدا کنید)*</label>\r\n            <input\r\n              type=\"text\"\r\n              {...register('categories')}\r\n              className={`w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${\r\n                errors.categories ? 'border-red-500' : 'border-gray-300'\r\n              }`}\r\n              disabled={isSubmitting}\r\n              placeholder=\"الکترونیک, لوازم خانگی\"\r\n            />\r\n            {errors.categories && (\r\n              <p className=\"mt-1 text-sm text-red-600\">{errors.categories.message}</p>\r\n            )}\r\n          </div>\r\n          \r\n          {/* Stock Field */}\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">موجودی*</label>\r\n            <input\r\n              type=\"number\"\r\n              {...register('stock', { valueAsNumber: true })}\r\n              min=\"0\"\r\n              className={`w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${\r\n                errors.stock ? 'border-red-500' : 'border-gray-300'\r\n              }`}\r\n              disabled={isSubmitting}\r\n            />\r\n            {errors.stock && (\r\n              <p className=\"mt-1 text-sm text-red-600\">{errors.stock.message}</p>\r\n            )}\r\n          </div>\r\n          \r\n          {/* Description Field */}\r\n          <div className=\"md:col-span-2\">\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">توضیحات*</label>\r\n            <textarea\r\n              {...register('description')}\r\n              className={`w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${\r\n                errors.description ? 'border-red-500' : 'border-gray-300'\r\n              }`}\r\n              rows=\"4\"\r\n              disabled={isSubmitting}\r\n            ></textarea>\r\n            {errors.description && (\r\n              <p className=\"mt-1 text-sm text-red-600\">{errors.description.message}</p>\r\n            )}\r\n          </div>\r\n          \r\n          {/* Image URL Field */}\r\n          <div className=\"md:col-span-2\">\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">آدرس تصویر*</label>\r\n            <input\r\n              type=\"url\"\r\n              {...register('imageUrl')}\r\n              className={`w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${\r\n                errors.imageUrl ? 'border-red-500' : 'border-gray-300'\r\n              }`}\r\n              disabled={isSubmitting}\r\n              placeholder=\"https://example.com/image.jpg\"\r\n            />\r\n            {errors.imageUrl && (\r\n              <p className=\"mt-1 text-sm text-red-600\">{errors.imageUrl.message}</p>\r\n            )}\r\n            <p className=\"mt-1 text-sm text-gray-500\">لطفا آدرس کامل تصویر را وارد کنید</p>\r\n          </div>\r\n        </div>\r\n        \r\n        <div className=\"mt-6 flex justify-end space-x-4\">\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => router.push('/dashboard/products')}\r\n            className=\"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 disabled:opacity-50 transition-colors\"\r\n            disabled={isSubmitting}\r\n          >\r\n            انصراف\r\n          </button>\r\n          <button\r\n            type=\"submit\"\r\n            className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n            disabled={isSubmitting}\r\n          >\r\n            {isSubmitting ? (\r\n              <span className=\"flex items-center\">\r\n                <svg className=\"animate-spin -ml-1 mr-2 h-4 w-4 text-white\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\r\n                  <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\r\n                  <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\r\n                </svg>\r\n                در حال ذخیره...\r\n              </span>\r\n            ) : 'ذخیره محصول'}\r\n          </button>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}