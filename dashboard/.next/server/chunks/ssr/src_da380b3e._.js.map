{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 5, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/saman/OneDrive/Desktop/OnlineStore/dashboard/src/lib/api/products.js"],"sourcesContent":["const API_BASE_URL = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://localhost:3000';\r\n\r\n// Common fetch wrapper\r\nasync function handleRequest(url, options = {}) {\r\n  try {\r\n    const res = await fetch(url, {\r\n      ...options,\r\n      headers: {\r\n        'Accept': 'application/json',\r\n        'Content-Type': 'application/json',\r\n        ...options.headers\r\n      },\r\n      cache: 'no-store'\r\n    });\r\n\r\n    if (!res.ok) {\r\n      const errorData = await res.json().catch(() => ({}));\r\n      throw new Error(errorData.error || `HTTP error! status: ${res.status}`);\r\n    }\r\n\r\n    return await res.json();\r\n  } catch (error) {\r\n    console.error(`API Error (${url}):`, error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n// Fetch products list with filters/pagination\r\nexport async function fetchProducts(params = {}) {\r\n  const {\r\n    page = 1,\r\n    limit = 10,\r\n    sort = 'createdAt',\r\n    order = 'desc',\r\n    bestSellers,\r\n    category,\r\n    minPrice,\r\n    maxPrice,\r\n    search\r\n  } = params;\r\n\r\n  const query = new URLSearchParams({\r\n    page,\r\n    limit,\r\n    sort,\r\n    order,\r\n    ...(bestSellers !== undefined && { bestSellers: bestSellers.toString() }),\r\n    ...(category && { category }),\r\n    ...(minPrice && { minPrice }),\r\n    ...(maxPrice && { maxPrice }),\r\n    ...(search && { search })\r\n  });\r\n\r\n  return handleRequest(`${API_BASE_URL}/api/products?${query.toString()}`);\r\n}\r\n\r\n// Create a new product\r\nexport async function createProduct(productData) {\r\n  return handleRequest(`${API_BASE_URL}/api/products`, {\r\n    method: 'POST',\r\n    body: JSON.stringify(productData)\r\n  });\r\n}\r\n\r\n// Update an existing product\r\nexport async function updateProduct({ _id, ...updateData }) {\r\n  return handleRequest(`${API_BASE_URL}/api/products`, {\r\n    method: 'PUT',\r\n    body: JSON.stringify({ _id, ...updateData })\r\n  });\r\n}\r\n\r\n// Delete a product by id\r\nexport async function deleteProduct(id) {\r\n  if (!id) throw new Error('Product ID is required for deletion');\r\n  return handleRequest(`${API_BASE_URL}/api/products?id=${id}`, {\r\n    method: 'DELETE'\r\n  });\r\n}\r\n\r\n// Get single product by id\r\nexport async function getProduct(id) {\r\n  if (!id) throw new Error('Product ID is required');\r\n  return handleRequest(`${API_BASE_URL}/api/products/${id}`);\r\n}\r\n"],"names":[],"mappings":";;;;;;;AAAA,MAAM,eAAe,6DAAwC;AAE7D,uBAAuB;AACvB,eAAe,cAAc,GAAG,EAAE,UAAU,CAAC,CAAC;IAC5C,IAAI;QACF,MAAM,MAAM,MAAM,MAAM,KAAK;YAC3B,GAAG,OAAO;YACV,SAAS;gBACP,UAAU;gBACV,gBAAgB;gBAChB,GAAG,QAAQ,OAAO;YACpB;YACA,OAAO;QACT;QAEA,IAAI,CAAC,IAAI,EAAE,EAAE;YACX,MAAM,YAAY,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;YAClD,MAAM,IAAI,MAAM,UAAU,KAAK,IAAI,CAAC,oBAAoB,EAAE,IAAI,MAAM,EAAE;QACxE;QAEA,OAAO,MAAM,IAAI,IAAI;IACvB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,CAAC,WAAW,EAAE,IAAI,EAAE,CAAC,EAAE;QACrC,MAAM;IACR;AACF;AAGO,eAAe,cAAc,SAAS,CAAC,CAAC;IAC7C,MAAM,EACJ,OAAO,CAAC,EACR,QAAQ,EAAE,EACV,OAAO,WAAW,EAClB,QAAQ,MAAM,EACd,WAAW,EACX,QAAQ,EACR,QAAQ,EACR,QAAQ,EACR,MAAM,EACP,GAAG;IAEJ,MAAM,QAAQ,IAAI,gBAAgB;QAChC;QACA;QACA;QACA;QACA,GAAI,gBAAgB,aAAa;YAAE,aAAa,YAAY,QAAQ;QAAG,CAAC;QACxE,GAAI,YAAY;YAAE;QAAS,CAAC;QAC5B,GAAI,YAAY;YAAE;QAAS,CAAC;QAC5B,GAAI,YAAY;YAAE;QAAS,CAAC;QAC5B,GAAI,UAAU;YAAE;QAAO,CAAC;IAC1B;IAEA,OAAO,cAAc,GAAG,aAAa,cAAc,EAAE,MAAM,QAAQ,IAAI;AACzE;AAGO,eAAe,cAAc,WAAW;IAC7C,OAAO,cAAc,GAAG,aAAa,aAAa,CAAC,EAAE;QACnD,QAAQ;QACR,MAAM,KAAK,SAAS,CAAC;IACvB;AACF;AAGO,eAAe,cAAc,EAAE,GAAG,EAAE,GAAG,YAAY;IACxD,OAAO,cAAc,GAAG,aAAa,aAAa,CAAC,EAAE;QACnD,QAAQ;QACR,MAAM,KAAK,SAAS,CAAC;YAAE;YAAK,GAAG,UAAU;QAAC;IAC5C;AACF;AAGO,eAAe,cAAc,EAAE;IACpC,IAAI,CAAC,IAAI,MAAM,IAAI,MAAM;IACzB,OAAO,cAAc,GAAG,aAAa,iBAAiB,EAAE,IAAI,EAAE;QAC5D,QAAQ;IACV;AACF;AAGO,eAAe,WAAW,EAAE;IACjC,IAAI,CAAC,IAAI,MAAM,IAAI,MAAM;IACzB,OAAO,cAAc,GAAG,aAAa,cAAc,EAAE,IAAI;AAC3D","debugId":null}},
    {"offset": {"line": 89, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/saman/OneDrive/Desktop/OnlineStore/dashboard/src/app/dashboard/products/edit/%5Bid%5D/EditProductForm.js"],"sourcesContent":["'use client';\r\n\r\nimport { useState } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { updateProduct } from '@/lib/api/products';\r\n\r\nexport default function EditProductForm({ product }) {\r\n  const router = useRouter();\r\n  const [formData, setFormData] = useState({\r\n    _id: product._id, // keep _id for update\r\n    name: product.name || '',\r\n    price: product.price || '',\r\n    description: product.description || '',\r\n    categories: (product.categories || []).join(', '),\r\n    stock: product.stock || 0,\r\n    imageUrl: product.imageUrl || '',\r\n    isBestSeller: product.isBestSeller || false,\r\n  });\r\n  const [error, setError] = useState(null);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n\r\n  const handleChange = (e) => {\r\n    const { name, value, type, checked } = e.target;\r\n    setFormData((prev) => ({\r\n      ...prev,\r\n      [name]: type === 'checkbox' ? checked : value,\r\n    }));\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setIsSubmitting(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const updatedProduct = {\r\n        ...formData,\r\n        price: Number(formData.price),\r\n        stock: Number(formData.stock),\r\n        categories: formData.categories\r\n          .split(',')\r\n          .map((c) => c.trim())\r\n          .filter(Boolean),\r\n      };\r\n\r\n      await updateProduct(updatedProduct);\r\n\r\n      router.push('/dashboard/products');\r\n      router.refresh();\r\n    } catch (err) {\r\n      setError(err.message || 'خطا در بروزرسانی محصول');\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <form\r\n      onSubmit={handleSubmit}\r\n      className=\"max-w-3xl mx-auto p-6 space-y-6 bg-white rounded-lg shadow-md\"\r\n    >\r\n      <h1 className=\"text-2xl font-semibold text-gray-800\">ویرایش محصول</h1>\r\n\r\n      {error && (\r\n        <p className=\"text-red-600 bg-red-100 p-3 rounded border border-red-400\">\r\n          {error}\r\n        </p>\r\n      )}\r\n\r\n      {/* Hidden input for _id */}\r\n      <input type=\"hidden\" name=\"_id\" value={formData._id} />\r\n\r\n      <div>\r\n        <label\r\n          htmlFor=\"name\"\r\n          className=\"block mb-1 text-gray-700 font-medium\"\r\n        >\r\n          نام محصول\r\n        </label>\r\n        <input\r\n          id=\"name\"\r\n          type=\"text\"\r\n          name=\"name\"\r\n          value={formData.name}\r\n          onChange={handleChange}\r\n          className=\"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100\"\r\n          disabled={isSubmitting}\r\n          required\r\n        />\r\n      </div>\r\n\r\n      <div>\r\n        <label\r\n          htmlFor=\"price\"\r\n          className=\"block mb-1 text-gray-700 font-medium\"\r\n        >\r\n          قیمت\r\n        </label>\r\n        <input\r\n          id=\"price\"\r\n          type=\"number\"\r\n          name=\"price\"\r\n          value={formData.price}\r\n          onChange={handleChange}\r\n          min=\"0\"\r\n          className=\"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100\"\r\n          disabled={isSubmitting}\r\n          required\r\n        />\r\n      </div>\r\n\r\n      <div>\r\n        <label\r\n          htmlFor=\"categories\"\r\n          className=\"block mb-1 text-gray-700 font-medium\"\r\n        >\r\n          دسته‌بندی‌ها\r\n        </label>\r\n        <input\r\n          id=\"categories\"\r\n          type=\"text\"\r\n          name=\"categories\"\r\n          value={formData.categories}\r\n          onChange={handleChange}\r\n          placeholder=\"مثلاً: الکترونیک, کامپیوتر\"\r\n          className=\"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100\"\r\n          disabled={isSubmitting}\r\n          required\r\n        />\r\n      </div>\r\n\r\n      <div>\r\n        <label\r\n          htmlFor=\"stock\"\r\n          className=\"block mb-1 text-gray-700 font-medium\"\r\n        >\r\n          موجودی\r\n        </label>\r\n        <input\r\n          id=\"stock\"\r\n          type=\"number\"\r\n          name=\"stock\"\r\n          value={formData.stock}\r\n          onChange={handleChange}\r\n          min=\"0\"\r\n          className=\"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100\"\r\n          disabled={isSubmitting}\r\n          required\r\n        />\r\n      </div>\r\n\r\n      <div>\r\n        <label\r\n          htmlFor=\"description\"\r\n          className=\"block mb-1 text-gray-700 font-medium\"\r\n        >\r\n          توضیحات\r\n        </label>\r\n        <textarea\r\n          id=\"description\"\r\n          name=\"description\"\r\n          value={formData.description}\r\n          onChange={handleChange}\r\n          rows=\"4\"\r\n          className=\"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 resize-none\"\r\n          disabled={isSubmitting}\r\n          required\r\n        />\r\n      </div>\r\n\r\n      <div>\r\n        <label\r\n          htmlFor=\"imageUrl\"\r\n          className=\"block mb-1 text-gray-700 font-medium\"\r\n        >\r\n          آدرس تصویر\r\n        </label>\r\n        <input\r\n          id=\"imageUrl\"\r\n          type=\"url\"\r\n          name=\"imageUrl\"\r\n          value={formData.imageUrl}\r\n          onChange={handleChange}\r\n          placeholder=\"https://example.com/image.jpg\"\r\n          className=\"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100\"\r\n          disabled={isSubmitting}\r\n          required\r\n        />\r\n      </div>\r\n\r\n      <div className=\"flex items-center space-x-2\">\r\n        <input\r\n          type=\"checkbox\"\r\n          name=\"isBestSeller\"\r\n          checked={formData.isBestSeller}\r\n          onChange={handleChange}\r\n          disabled={isSubmitting}\r\n          id=\"isBestSeller\"\r\n          className=\"h-5 w-5 text-blue-600 rounded border-gray-300 focus:ring-blue-500\"\r\n        />\r\n        <label\r\n          htmlFor=\"isBestSeller\"\r\n          className=\"text-gray-700 select-none\"\r\n        >\r\n          Mark as Best Seller\r\n        </label>\r\n      </div>\r\n\r\n      {formData.imageUrl && (\r\n        <img\r\n          src={formData.imageUrl}\r\n          alt=\"Preview\"\r\n          className=\"h-48 w-48 object-contain border rounded mx-auto\"\r\n          onError={(e) => {\r\n            e.target.onerror = null;\r\n            e.target.src = '/placeholder-product.jpg';\r\n          }}\r\n        />\r\n      )}\r\n\r\n      <button\r\n        type=\"submit\"\r\n        disabled={isSubmitting}\r\n        className=\"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-semibold py-3 rounded-md transition-colors\"\r\n      >\r\n        {isSubmitting ? 'در حال بروزرسانی...' : 'ذخیره تغییرات'}\r\n      </button>\r\n    </form>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}